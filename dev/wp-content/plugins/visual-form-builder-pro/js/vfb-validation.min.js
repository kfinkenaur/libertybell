jQuery(document).ready(function(d){d(".visual-form-builder").each(function(){d(this).validate({rules:{recaptcha_response_field:{required:true}},onkeyup:function(j){if(j.type=="password"){this.element(j)}else{return true}},errorClass:"vfb-error",errorPlacement:function(j,k){if((k.is(":radio")||k.is(":checkbox"))&&!k.hasClass("vfb-likert-option")){j.appendTo(k.parent().parent())}else{if(k.is(":password")){j.hide()}else{if("recaptcha_response_field"==k.attr("id")){j.insertAfter("#recaptcha_table")}else{if(k.hasClass("vfb-likert-option")){j.insertAfter(k.closest("tr"))}else{j.insertAfter(k)}}}}}})});d(".visual-form-builder li:not(.vfb-item-instructions li, .vfb-span li)").filter(function(){return d(this).css("list-style-type")!=="none"}).css("list-style","none");d(".vfb-date-picker").each(function(){var j=d(this).attr("data-dp-dateFormat")?d(this).attr("data-dp-dateFormat"):"mm/dd/yy";d(this).datepicker({dateFormat:j})});b();d(document).on("click",".vfb-page-next",function(l){l.preventDefault();var m=d(this).attr("id"),k=parseInt(m.replace(/page-/,"")),j="#"+d(this).parents("form.visual-form-builder").attr("id");if(!d(j).valid()){return}d(".page-"+k).fadeIn();d("html, body").animate({scrollTop:d(".page-"+k).offset().top-50});d(this).fadeOut();b()});d(".colorPicker").each(function(){var j=d(this).attr("id").match(new RegExp(/(\d+)$/g),"");d(this).farbtastic("#vfb-"+j)});d(".colorPicker").hide();d(".vfb-color-picker:input").focus(function(){var j=d(this).attr("id").match(new RegExp(/(\d+)$/g),"");d("#vfb-colorPicker-"+j).show()}).blur(function(){var j=d(this).attr("id").match(new RegExp(/(\d+)$/g),"");d("#vfb-colorPicker-"+j).hide()});d(".auto").each(function(){var j=d(this).closest("form").find('input[name="form_id"]').val();var k=d(this).attr("id").match(new RegExp(/(\d+)$/g),"");d("#"+d(this).attr("id")).autocomplete({delay:200,source:function(m,l){d.ajax({url:VfbAjax.ajaxurl,type:"GET",async:true,cache:false,dataType:"json",data:{action:"visual_form_builder_autocomplete",term:m.term,form:j,field:k[0]},success:function(n){l(d.map(n,function(o){return{value:o.value}}))}})}})});if(window.VfbRules){var c=d.parseJSON(VfbRules.rules);var g=[];i(c);d(c).each(function(){d.each(this.rules,function(j){g.push("[name^=vfb-"+this.field+"]")})});d(g.join(",")).change(function(){i(c)})}function f(m,l){var j=d("[name^=vfb-"+m+"]");if(j.length>0){for(var k=0;k<j.length;k++){if(d(j[k]).is("[type=checkbox],[type=radio]")){if(a(d(j[k]).val())==l&&d(j[k]).is(":checked")){return true}}else{if(d(j[k]).is("select")){if(a(d(j[k]).val())==l){return true}}}}}else{if(a(d("[name^=vfb-"+m+"]").val())==l){return true}}return false}function a(j){if(!j){return""}var j=j.split("|");return j[0]}function i(j){d(j).each(function(){var n=this.field_id,q="item-vfb-"+n,l=this.conditional_show,p=this.rules,m=this.conditional_logic,o=0,k="";k=(l=="show")?"hide":"show";d.each(p,function(r){this.option=this.option.replace("\\","");if((this.condition=="is"&&f(this.field,this.option))||(this.condition=="isnot"&&!f(this.field,this.option))){o++}});if((m=="all"&&o==p.length)||(m=="any"&&o>0)){d("[id="+q+"]")[l]()}else{d("[id="+q+"]")[k]()}if(!d("#"+q).is(":visible")){d("#"+q+" :input").prop("disabled","disabled")}else{d("#"+q+" :input").prop("disabled",false)}})}d(".vfb-textarea-word-count").keyup(function(){var m={},l=e(this.value),j=l.match(/\b/gi),k=0;m[this.id]=j?j.length/2:0;d.each(m,function(o,n){k+=n});d(this).parent().find(".vfb-word-count-total").text(k)});function b(){if(d(".vfb-page .vfb-item-submit").is(":visible")){d(".vfb-page .vfb-submit").prop("disabled",false)}else{d(".vfb-page .vfb-submit").prop("disabled","disabled")}}function h(j){return j.replace(/<.[^<>]*?>/g," ").replace(/&nbsp;|&#160;/gi," ").replace(/[.(),;:!?%#$'"_+=\/-]*/g,"")}function e(j){return j.replace(/[\u00E1\u00E2\u00E4\u00E6\u00E3\u00E5\u0101]+/gi,"a").replace(/[\u00E7\u0107\u010D]+/gi,"c").replace(/[\u00E8\u00E9\u00EA\u00EB\u0113\u0117\u0119]+/gi,"e").replace(/[\u00F4\u00F6\u00F2\u00F3\u0153\u00F8\u014D\u00F5]+/gi,"o").replace(/[\u00DF\u015B\u0161Ss]+/gi,"s").replace(/[\u00FB\u00FC\u00F9\u00FA\u016B]+/gi,"u").replace(/[\u00FF]+/gi,"y").replace(/[\u017E\u017A\u017C]+/gi,"z")}d.validator.addMethod("vfbUsername",function(l,k){var j=true;if(l.length>0){d.ajax({url:VfbAjax.ajaxurl,type:"GET",async:false,cache:false,dataType:"text",data:{action:"visual_form_builder_check_username",username:l},success:function(m){j=(m=="true")?true:false}})}return this.optional(k)||j},d.validator.messages.vfbUsername);d.validator.addMethod("phone",function(k,j){k=k.replace(/[\+\s\(\)\.\-\ ]/g,"");return this.optional(j)||k.length>9&&k.match(/^((\+)?[1-9]{1,2})?([-\s\.])?((\(\d{1,4}\))|\d{1,4})(([-\s\.])?[0-9]{1,12}){1,2}$/)},d.validator.messages.phone);d.validator.addMethod("ipv4",function(k,j){return this.optional(j)||/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/i.test(k)},d.validator.messages.ipv4);d.validator.addMethod("ipv6",function(k,j){return this.optional(j)||/^((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))$/i.test(k)},d.validator.messages.ipv6);d.validator.addMethod("maxWords",function(k,j,l){return this.optional(j)||h(e(k)).match(/\b\w+\b/g).length<=l},d.validator.messages.maxWords);d.validator.addMethod("minWords",function(k,j,l){return this.optional(j)||h(e(k)).match(/\b\w+\b/g).length>=l},d.validator.messages.minWords);d.validator.addMethod("rangeWords",function(m,j,n){var l=h(e(m));var k=/\b\w+\b/g;return this.optional(j)||l.match(k).length>=n[0]&&l.match(k).length<=n[1]},d.validator.messages.rangeWords);d.validator.addMethod("alphanumeric",function(k,j){return this.optional(j)||/^\w+$/i.test(k)},d.validator.messages.alphanumeric);d.validator.addMethod("lettersonly",function(k,j){return this.optional(j)||/^[a-z]+$/i.test(k)},d.validator.messages.lettersonly);d.validator.addMethod("nowhitespace",function(k,j){return this.optional(j)||/^\S+$/i.test(k)},d.validator.messages.nowhitespace);d.validator.addMethod("ziprange",function(k,j){return this.optional(j)||/^90[2-5]\d\{2\}-\d{4}$/.test(k)},d.validator.messages.ziprange);d.validator.addMethod("zipcodeUS",function(k,j){return this.optional(j)||/\d{5}-\d{4}$|^\d{5}$/.test(k)},d.validator.messages.zipcodeUS);d.validator.addMethod("integer",function(k,j){return this.optional(j)||/^-?\d+$/.test(k)},d.validator.messages.ziprange)});(function(f){var b=/[a-z]/,g=/[A-Z]/,e=/[0-9]/,i=/[0-9].*[0-9]/,a=/[^a-zA-Z0-9]/,h=/^(.)\1+$/;function d(j,k){return{rate:j,messageKey:k}}function c(j){return j.substring(0,1).toLowerCase()+j.substring(1)}f.validator.passwordRating=function(l,p){if(!l||l.length<8){return d(0,"too-short")}if(p&&l.toLowerCase().match(p.toLowerCase())){return d(0,"similar-to-username")}if(h.test(l)){return d(1,"very-weak")}var k=b.test(l),m=g.test(c(l)),o=e.test(l),n=i.test(l),j=a.test(l);if(k&&m&&o||k&&n||m&&n||j){return d(4,"strong")}if(k&&m||k&&o||m&&o){return d(3,"good")}return d(2,"weak")};f.validator.passwordRating.messages={"similar-to-username":"Too similar to username","too-short":"Too short","very-weak":"Very weak",weak:"Weak",good:"Good",strong:"Strong"};f.validator.addMethod("password",function(n,k,o){var j=k.value,p=f(typeof o!="boolean"?o:[]);var l=f.validator.passwordRating(j,p.val());var m=f(".password-meter",k.form);m.removeClass("similar-to-username too-short very-weak weak good strong").addClass(l.messageKey).text(f.validator.passwordRating.messages[l.messageKey]);if(this.optional(k)){m.removeClass("similar-to-username too-short very-weak weak good strong").text("Password Strength");return true}return l.rate>2},"&nbsp;");f.validator.classRuleSettings.password={password:true}})(jQuery);